# General Behavior Rules ‚Äî APE 2026

## G-001: No Yapping
- **Straight to the point**: –ë–µ–∑ "–ö–æ–Ω–µ—á–Ω–æ, —è –ø–æ–º–æ–≥—É –≤–∞–º..."
- **Concise responses**: –ö—Ä–∞—Ç–∫–∏–µ –∏ —á–µ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã
- **Action-first**: –°–Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏–µ, –ø–æ—Ç–æ–º –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```
‚ùå BAD:
"–ö–æ–Ω–µ—á–Ω–æ! –Ø —Å —Ä–∞–¥–æ—Å—Ç—å—é –ø–æ–º–æ–≥—É –≤–∞–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Truth Boundary Gate.
–≠—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è zero hallucination..."

‚úÖ GOOD:
"–†–µ–∞–ª–∏–∑—É—é Truth Boundary Gate..."
[–∫–æ–¥/–¥–µ–π—Å—Ç–≤–∏–µ]
```

---

## G-002: Language
- **Code \& Comments**: English
- **Chat \& Documentation**: Russian (unless specified)
- **Variable names**: English, descriptive (no single letters except loops)

```python
# ‚úÖ GOOD
def validate_truth_boundary(text: str, facts: List[VerifiedFact]) -> ValidationResult:
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Å–µ —á–∏—Å–ª–∞ –≤ —Ç–µ–∫—Å—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã —Ñ–∞–∫—Ç–∞–º–∏."""

# ‚ùå BAD
def proverka(t: str, f: list) -> dict:  # Bad: transliteration, cryptic names
```

---

## G-003: Completeness (CRITICAL)
**–ù–ò–ö–ê–ö–ò–• –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤, –ù–ò–ö–û–ì–î–ê.**

```python
# ‚ùå BAD ‚Äî –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –∑–∞–ø—Ä–µ—â–µ–Ω—ã
def execute_in_vee(code: str) -> Result:
    # Validate code
    # ... rest of implementation ...  # ‚ùå NO!
    pass

# ‚úÖ GOOD ‚Äî –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
def execute_in_vee(code: str) -> Result:
    validate_code_safety(code)
    validate_code_syntax(code)

    container = docker.from_env().containers.run(
        image="ape-sandbox:latest",
        command=["python", "-c", code],
        network_mode="custom",
        mem_limit="2g",
        timeout=60,
        detach=False
    )

    return Result(
        stdout=container.logs().decode(),
        exit_code=container.attrs['State']['ExitCode']
    )
```

**Enforcement:**
- Code review: "–ï—Å—Ç—å –ª–∏ '...' –∏–ª–∏ 'rest of implementation'?" ‚Üí BLOCK
- CI lint check: grep –¥–ª—è `# ...` patterns

---

## G-004: Documentation
- **Docstrings**: Google style –¥–ª—è –≤—Å–µ—Ö public —Ñ—É–Ω–∫—Ü–∏–π/–∫–ª–∞—Å—Å–æ–≤
- **Type hints**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- **Comments**: –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–π –ª–æ–≥–∏–∫–∏ (–∫–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å self-explanatory)

```python
def calculate_sensitivity_score(
    base_value: float,
    variations: List[float]
) -> float:
    """Calculate stability score from parameter variations.

    Higher score = more stable calculation across parameters.

    Args:
        base_value: Original calculation result
        variations: Results with different parameters

    Returns:
        Score from 0.0 (unstable) to 1.0 (perfectly stable)

    Raises:
        ValueError: If variations is empty

    Example:
        >>> calculate_sensitivity_score(15.3, [14.8, 15.1, 15.9])
        0.87
    """
    if not variations:
        raise ValueError("variations cannot be empty")

    deltas = [(v - base_value) / base_value for v in variations]
    return 1.0 / (1.0 + np.std(deltas))
```

---

## G-005: Error Handling
- **Fail-fast –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫**: Security violations, data corruption
- **Fail-gracefully –¥–ª—è –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö**: API timeouts, cache misses
- **Always log errors**: –° –ø–æ–ª–Ω—ã–º context (episode_id, timestamp, stack trace)

```python
# Fail-fast (–∫—Ä–∏—Ç–∏—á–Ω–æ)
def validate_sandbox_isolation():
    if can_access_host_filesystem():
        raise SecurityViolation("Sandbox not isolated! CRITICAL.")

# Fail-gracefully (–Ω–µ–∫—Ä–∏—Ç–∏—á–Ω–æ)
def fetch_market_data(symbol: str) -> Optional[pd.DataFrame]:
    try:
        return yfinance.download(symbol)
    except Exception as e:
        logger.warning(f"YFinance failed for {symbol}: {e}, using cache")
        return cache.get(symbol)  # Fallback
```

---

## G-006: Code Style
- **Formatter**: Black (line length 100)
- **Linter**: Ruff (fast)
- **Type checker**: mypy (strict mode)
- **Pre-commit hooks**: –ê–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ + –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# Pre-commit check
black src/ tests/ --check
ruff check src/ tests/
mypy src/
```

---

## G-007: Git Commits
- **Conventional Commits**: `type(scope): message`
- **Types**: feat, fix, docs, test, refactor, chore
- **Scope**: component name (vee, truth-gate, api, etc.)

```bash
# ‚úÖ GOOD
git commit -m "feat(vee): add Docker network isolation"
git commit -m "fix(truth-gate): handle percentages correctly"
git commit -m "test(temporal): add publication lag edge cases"

# ‚ùå BAD
git commit -m "fixed bug"
git commit -m "WIP"
git commit -m "update"
```

---

## G-008: No Over-Engineering
- **YAGNI**: You Aren't Gonna Need It
- **Implement —Ç–æ–ª—å–∫–æ —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–µ–π—á–∞—Å**: –ù–µ –¥–æ–±–∞–≤–ª—è—Ç—å "–Ω–∞ –±—É–¥—É—â–µ–µ"
- **Prefer simple over clever**: –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å > –∫—Ä–∞—Ç–∫–æ—Å—Ç—å

```python
# ‚ùå BAD ‚Äî Over-engineered –¥–ª—è MVP
class AbstractFactoryStrategyObserverVisitor:
    def create_dynamic_configurable_validator_chain(...):
        # 500 lines of abstraction hell

# ‚úÖ GOOD ‚Äî Simple, direct
def validate_truth_boundary(text: str, facts: List[VerifiedFact]) -> ValidationResult:
    numbers = extract_numbers(text)
    fact_refs = extract_fact_references(text)

    for num in numbers:
        if not has_matching_fact(num, facts):
            return ValidationResult(verdict="BLOCK", reason=f"Unverified: {num}")

    return ValidationResult(verdict="PASS")
```

---

## G-009: Memory Bank Discipline
**–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π significant —Å–µ—Å—Å–∏–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):**

1. Update `activeContext.md`:
   - –ß—Ç–æ —Å–¥–µ–ª–∞–ª–∏
   - –ß—Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏
   - –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥
   - –ë–ª–æ–∫–µ—Ä—ã

2. Update `progress.md`:
   - –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ [x]
   - –û–±–Ω–æ–≤–∏—Ç—å progress bars
   - –ó–∞–ø–∏—Å–∞—Ç—å activity log

3. Update `decisions.md`:
   - –ï—Å–ª–∏ –ø—Ä–∏–Ω—è–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ ‚Üí –Ω–æ–≤—ã–π ADR
   - –ï—Å–ª–∏ —Ä–µ—à–µ–Ω–∏–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å ‚Üí update ADR status

4. Git commit:
   ```bash
   git add .cursor/memory_bank/
   git commit -m "docs: update memory bank after session [component]"
   ```

**Frequency:**
- activeContext.md: –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ)
- progress.md: –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
- decisions.md: –ü–æ—Å–ª–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è (—Ä–µ–¥–∫–æ)

---

## G-010: AI Delegation Protocol
**–ö–æ–≥–¥–∞ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∑–∞–¥–∞—á–∏ –¥—Ä—É–≥–∏–º AI:**

| Task | Delegate To | Why |
|------|-------------|-----|
| –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ | Cursor Composer | –õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, fast |
| Unit tests generation | Codex/GPT | Boilerplate, patterns |
| Docstrings | Codex/GPT | Formulaic |
| –ê–Ω–∞–ª–∏–∑ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (>50KB) | Kimi | Long context |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è | Opus 4.6 | Deep reasoning |
| Security audit | Opus 4.6 | Critical thinking |

**Format –¥–µ–ª–µ–≥–∞—Ü–∏–∏:**
```
–î–ï–õ–ï–ì–ê–¶–ò–Ø ‚Üí [Opus]

–ü—Ä–æ–≤–µ–¥–∏ security audit VEE sandbox:
- [context]
- [specific checks]

–§–æ—Ä–º–∞—Ç: security_audit_report.md

---
–°–æ–æ–±—â–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–≥–¥–∞ –≥–æ—Ç–æ–≤–æ
```

---

## G-011: Opus/Sonnet Switching Strategy
**Default: Sonnet** (—ç–∫–æ–Ω–æ–º–∏—è $50 –ø—Ä–æ–º–æ)

**Escalate to Opus ONLY when:**
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (database choice, workflow design)
- Security review/audit (–∫—Ä–∏—Ç–∏—á–Ω–æ)
- Complex debugging (–Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã–π –±–∞–≥, race conditions)
- Research –Ω–æ–≤—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π (DeepSeek-R1 evaluation)

```bash
# –ù–∞—á–∞–ª–æ —Å–µ—Å—Å–∏–∏ ‚Äî –≤—Å–µ–≥–¥–∞ Sonnet
/model sonnet

# –ï—Å–ª–∏ –∑–∞—Å—Ç—Ä—è–ª–∏ –∏–ª–∏ –Ω—É–∂–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
/model opus
"[–≥–ª—É–±–æ–∫–∏–π –≤–æ–ø—Ä–æ—Å]"

# –ü–æ–ª—É—á–∏–ª–∏ –æ—Ç–≤–µ—Ç ‚Äî —Å—Ä–∞–∑—É –æ–±—Ä–∞—Ç–Ω–æ
/model sonnet
```

**–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Opus –¥–ª—è:**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è boilerplate –∫–æ–¥–∞
- Simple CRUD operations
- –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
- Docstrings
- –ö–æ–º–º–∏—Ç-—Å–æ–æ–±—â–µ–Ω–∏—è

---

## G-012: Code Review Checklist
–ü–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º PR/commit –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

- [ ] Tests –Ω–∞–ø–∏—Å–∞–Ω—ã –ü–ï–†–ï–î –∫–æ–¥–æ–º (TDD)
- [ ] Coverage >= 80% (95% –¥–ª—è critical components)
- [ ] –ù–µ—Ç –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤ (`...`, `TODO`, `FIXME` –±–µ–∑ issue)
- [ ] Type hints –Ω–∞ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
- [ ] Docstrings –Ω–∞ public API
- [ ] Secrets —á–µ—Ä–µ–∑ environment variables
- [ ] Black + Ruff passed
- [ ] mypy passed
- [ ] activeContext.md updated
- [ ] progress.md updated (–µ—Å–ª–∏ –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞)

---

## G-013: Performance Guidelines
- **Optimize –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ profiling**: "Premature optimization is the root of all evil"
- **Target latencies**:
  - Truth Boundary Gate: <1 sec –¥–ª—è 10K chars
  - VEE execution: <60 sec per step
  - Neo4j query: <500 ms
  - Full workflow: <120 sec (P95)

- **Caching strategy**:
  - L1 (in-memory): –ª—è–º–±–¥—ã, hot path
  - L2 (Redis): API responses, 1-hour TTL
  - L3 (Neo4j): immutable facts, forever

---

## G-014: No Emojis (Unless Explicit Request)
- **Default**: Clean, professional text
- **Exception**: User explicitly asks ("–¥–æ–±–∞–≤—å —ç–º–æ–¥–∑–∏")

```
‚ùå BAD:
"–û—Ç–ª–∏—á–Ω–æ! ‚ú® –†–µ–∞–ª–∏–∑—É—é Truth Boundary! üöÄ"

‚úÖ GOOD:
"–†–µ–∞–ª–∏–∑—É—é Truth Boundary."
```

---

## G-015: Context Management
- **Before tool calls**: Check if necessary (–Ω–µ —á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π —Ç–æ–ª—å–∫–æ —á—Ç–æ —á–∏—Ç–∞–ª–∏)
- **Minimize context bloat**: –ù–µ –¥–æ–±–∞–≤–ª—è—Ç—å –ª–∏—à–Ω–∏–µ —Ñ–∞–π–ª—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
- **Use /compact**: –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç >70% (–º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Ç—Ä–µ–±—É–µ—Ç)

```
# BAD: —á—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ–¥—Ä—è–¥
Read entire codebase ‚Üí blow up context

# GOOD: —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —á—Ç–µ–Ω–∏–µ
Read truth_boundary.py ‚Üí analyze ‚Üí done
```

---

*–≠—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ APE 2026*
*Violations = technical debt*
*Last Updated: 2026-02-07*
