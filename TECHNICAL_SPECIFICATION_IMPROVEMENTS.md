# üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é APE 2026

**–û—Å–Ω–æ–≤–∞:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ (Claude Opus 4.6 Audit)
**–¢–µ–∫—É—â–∞—è –æ—Ü–µ–Ω–∫–∞:** 6.1/10
**–¶–µ–ª–µ–≤–∞—è –æ—Ü–µ–Ω–∫–∞:** 8.5/10 (Production-Ready)
**–°—Ä–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 4 –Ω–µ–¥–µ–ª–∏ (Week 11-14)
**–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è:** MoSCoW (Must/Should/Could/Won't)

---

## üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ —Ü–µ–ª–∏

1. **–ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –ø—Ä–æ—Ç–æ—Ç–∏–ø –≤ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø—Ä–æ–¥—É–∫—Ç** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞–≥–ª—É—à–∫–∏
2. **–£—Å—Ç—Ä–∞–Ω–∏—Ç—å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏** - compliance –∏ disclaimers
3. **–î–æ—Å—Ç–∏—á—å production-readiness** - real integration tests, monitoring, performance
4. **–°–Ω–∏–∑–∏—Ç—å technical debt** - —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ God Objects, –¥–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
5. **–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é** - async, auto-scaling, cost tracking

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ vs –¶–µ–ª–µ–≤–æ–µ

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ–∫—É—â–∞—è –æ—Ü–µ–Ω–∫–∞ | –¶–µ–ª–µ–≤–∞—è | –î–µ–ª—å—Ç–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|-----------|----------------|---------|--------|-----------|
| ML/AI Pipeline | 5/10 | 9/10 | +4 | üî¥ CRITICAL |
| –ë–∏–∑–Ω–µ—Å/Compliance | 2/10 | 8/10 | +6 | üî¥ CRITICAL |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | 5/10 | 8/10 | +3 | üü° HIGH |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 7/10 | 9/10 | +2 | üü° HIGH |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 6/10 | 8/10 | +2 | üü° HIGH |
| –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å | 6/10 | 8/10 | +2 | üü¢ MEDIUM |
| Frontend/UX | 6/10 | 8/10 | +2 | üü¢ MEDIUM |
| –î–∞–Ω–Ω—ã–µ –∏ –ë–î | 7/10 | 9/10 | +2 | üü¢ MEDIUM |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 7/10 | 9/10 | +2 | üü¢ MEDIUM |
| **–û–ë–©–ê–Ø** | **6.1/10** | **8.5/10** | **+2.4** | - |

---

## üî¥ PHASE 1: CRITICAL FIXES (Week 11) ‚Äî Must Have

**–¶–µ–ª—å:** –£—Å—Ç—Ä–∞–Ω–∏—Ç—å show-stoppers, –∫–æ—Ç–æ—Ä—ã–µ –±–ª–æ–∫–∏—Ä—É—é—Ç production deployment

### 1.1 LLM Integration (ML/AI Pipeline: 5‚Üí9)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ß–ê–°–¢–ò–ß–ù–û COMPLETE** (Week 11 Day 1)
- ‚úÖ OpenAI integration —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ Gemini integration —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ DeepSeek integration —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ Cost tracking –¥–æ–±–∞–≤–ª–µ–Ω
- ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å orchestrator

**–ó–∞–¥–∞—á–∏:**

#### 1.1.1 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ —Å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**Effort:** M (3 –¥–Ω—è)
**Owner:** Backend Team

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (OpenAI, Gemini, DeepSeek) –≤ `DebateNode` –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤–º–µ—Å—Ç–æ mock-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.

**Acceptance Criteria:**
- [ ] `DebateNode` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —á–µ—Ä–µ–∑ environment variables (`LLM_PROVIDER=openai|gemini|deepseek`)
- [ ] Fallback –Ω–∞ mock —Ç–æ–ª—å–∫–æ –≤ test environment
- [ ] Retry logic —Å exponential backoff –¥–ª—è API failures
- [ ] Circuit breaker –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç API outages
- [ ] Cost tracking –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ –ë–î (new table: `llm_api_usage`)

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
```python
# src/orchestration/nodes/debate_node.py
class DebateNode:
    def __init__(self):
        provider = os.getenv("LLM_PROVIDER", "deepseek")  # Default to cheapest
        self.llm_client = LLMDebateNode(provider=provider)
        self.circuit_breaker = CircuitBreaker(
            failure_threshold=5,
            recovery_timeout=60
        )

    async def execute(self, state: GraphState) -> GraphState:
        try:
            with self.circuit_breaker:
                result = await self.llm_client.generate_debate_async(fact)
                await self._log_cost(result.cost)
        except CircuitBreakerOpen:
            # Fallback to cached/simplified response
            logger.error("LLM circuit breaker open, using fallback")
```

**–§–∞–π–ª—ã:**
- `src/orchestration/nodes/debate_node.py` (modify)
- `src/storage/timescale_client.py` (add llm_api_usage table)
- `tests/integration/test_debate_node_real_llm.py` (new)

---

#### 1.1.2 Async LLM Calls
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**Effort:** M (2 –¥–Ω—è)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ LLM –≤—ã–∑–æ–≤—ã –≤ async –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è blocking.

**Acceptance Criteria:**
- [ ] `_call_openai`, `_call_gemini`, `_call_deepseek` –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ async
- [ ] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `httpx.AsyncClient` –≤–º–µ—Å—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- [ ] Timeout configuration per provider (default: 30s)
- [ ] Concurrent debates –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–∫—Ç–æ–≤ (asyncio.gather)
- [ ] Benchmark: 3 debates –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ < 10s (vs 30s sequential)

**–ü—Ä–∏–º–µ—Ä:**
```python
async def _call_openai_async(self, prompt: str) -> Dict[str, Any]:
    async with httpx.AsyncClient(timeout=30.0) as client:
        response = await client.post(
            "https://api.openai.com/v1/chat/completions",
            headers={"Authorization": f"Bearer {self.api_key}"},
            json={...}
        )
```

---

#### 1.1.3 Prompt Versioning
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**Effort:** S (1 –¥–µ–Ω—å)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è A/B —Ç–µ—Å—Ç–∏–Ω–≥–∞ –∏ rollback.

**Acceptance Criteria:**
- [ ] –ü—Ä–æ–º–ø—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `prompts/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –≤–µ—Ä—Å–∏—è–º–∏
- [ ] –§–æ—Ä–º–∞—Ç: `prompts/debate/sharpe_ratio_v1.txt`, `v2.txt`
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –≤ environment (`PROMPT_VERSION=v2`)
- [ ] A/B testing: 50/50 split –º–µ–∂–¥—É v1 –∏ v2 –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- [ ] Metrics: accuracy, cost, latency per prompt version

---

### 1.2 Compliance & Legal (–ë–∏–∑–Ω–µ—Å/Compliance: 2‚Üí8)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL (—é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π —Ä–∏—Å–∫)
**Effort:** S (2 –¥–Ω—è)

#### 1.2.1 Disclaimer Integration
**Acceptance Criteria:**
- [ ] **API Response Disclaimer:**
  ```json
  {
    "result": {...},
    "disclaimer": "This analysis is for informational purposes only and does not constitute investment advice. Past performance does not guarantee future results. Always consult with a qualified financial advisor before making investment decisions.",
    "data_sources": ["Yahoo Finance", "LLM: DeepSeek"],
    "generated_at": "2026-02-08T12:34:56Z"
  }
  ```
- [ ] **Frontend UI Disclaimer:**
  - Footer –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö
  - Modal –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ (accepted via checkbox, stored in localStorage)
  - Disclaimer banner –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ results
- [ ] **Email/Export Disclaimer:**
  - –í–∫–ª—é—á–∏—Ç—å –≤ PDF/CSV —ç–∫—Å–ø–æ—Ä—Ç—ã
  - Email footer
- [ ] **Terms of Service page** (`/terms`)
- [ ] **Privacy Policy page** (`/privacy`)

**–§–∞–π–ª—ã:**
- `src/api/schemas.py` (add disclaimer field to all response models)
- `src/api/middleware/disclaimer_middleware.py` (new)
- `frontend/components/layout/Footer.tsx` (update)
- `frontend/components/DisclaimerModal.tsx` (new)
- `frontend/app/terms/page.tsx` (new)
- `frontend/app/privacy/page.tsx` (new)

---

#### 1.2.2 Immutable Audit Trail
**Acceptance Criteria:**
- [ ] All user queries logged to **WORM storage** (Write-Once-Read-Many)
- [ ] Log format:
  ```json
  {
    "query_id": "uuid",
    "user_id": "api_key_hash",
    "timestamp": "ISO8601",
    "query": "text",
    "results": {...},
    "llm_provider": "deepseek",
    "cost": 0.000264,
    "ip_address": "hashed",
    "user_agent": "string"
  }
  ```
- [ ] Retention policy: 7 years (financial compliance standard)
- [ ] Encryption at rest (AES-256)
- [ ] Tamper detection: cryptographic hash chain
- [ ] Export API –¥–ª—è compliance audits

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:**
- TimescaleDB —Å continuous aggregates –¥–ª—è WORM-like behavior
- –ò–ª–∏ AWS S3 —Å Object Lock (compliance mode)

**–§–∞–π–ª—ã:**
- `src/storage/audit_trail.py` (new)
- `src/api/middleware/audit_middleware.py` (new)

---

#### 1.2.3 Data Source Attribution
**Acceptance Criteria:**
- [ ] –ö–∞–∂–¥—ã–π —Ñ–∞–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç `source` field:
  ```python
  {
    "statement": "AAPL Sharpe ratio is 1.95",
    "value": 1.95,
    "source": "Yahoo Finance",
    "source_url": "https://finance.yahoo.com/quote/AAPL",
    "fetched_at": "2026-02-08T10:00:00Z",
    "verified": true
  }
  ```
- [ ] UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç source –∫–∞–∫ hyperlink
- [ ] API endpoint `/api/v1/sources` –¥–ª—è —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö data sources

---

### 1.3 Cost Tracking & Unit Economics (–ë–∏–∑–Ω–µ—Å/Compliance: 2‚Üí8)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**Effort:** S (1 –¥–µ–Ω—å)

#### 1.3.1 Per-Query Cost Tracking
**Acceptance Criteria:**
- [ ] Middleware –ª–æ–≥–∏—Ä—É–µ—Ç cost –¥–ª—è –∫–∞–∂–¥–æ–≥–æ query
- [ ] Cost breakdown:
  - LLM API cost (OpenAI/Gemini/DeepSeek)
  - Data fetching cost (if applicable)
  - Compute cost (estimation based on execution time)
- [ ] Dashboard –≤ Grafana:
  - Cost per day/week/month
  - Cost per user
  - Cost per LLM provider
  - Average cost per query
- [ ] Alerting –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ budget ($100/day)

**–§–∞–π–ª—ã:**
- `src/api/middleware/cost_tracking_middleware.py` (new)
- `src/storage/timescale_client.py` (add query_costs table)
- `grafana/dashboards/cost_dashboard.json` (new)

---

#### 1.3.2 Unit Economics Model
**Acceptance Criteria:**
- [ ] –î–æ–∫—É–º–µ–Ω—Ç `docs/UNIT_ECONOMICS.md`:
  ```
  Cost per Query:
    - LLM API (DeepSeek): $0.000264
    - Data fetching: $0.00001
    - Infrastructure: $0.00005
    - Total: $0.000324

  Revenue per Query (hypothetical):
    - Free tier: $0 (limit: 100 queries/month)
    - Pro tier: $0.01 per query
    - Margin: $0.00968 (96.8%)

  Break-even: 10,340 Pro queries/month at $5K infrastructure cost
  ```
- [ ] Pricing calculator: `scripts/pricing_calculator.py`

---

### 1.4 Real Integration Tests (–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 7‚Üí9)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**Effort:** M (3 –¥–Ω—è)

#### 1.4.1 Golden Set —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ LLM
**Acceptance Criteria:**
- [ ] –ü—Ä–æ–≥–Ω–∞—Ç—å –≤—Å–µ 30 Golden Set queries —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ã–π LLM (DeepSeek)
- [ ] –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å baseline –º–µ—Ç—Ä–∏–∫–∏:
  - Accuracy: ‚â•90% (within tolerance)
  - Hallucination rate: 0%
  - Temporal compliance: 100%
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `tests/golden_set/results/baseline_deepseek_2026_02_08.json`
- [ ] CI/CD: —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
pytest tests/integration/test_golden_set_production.py \
  --llm-provider=deepseek \
  --save-baseline \
  -m real_llm
```

---

#### 1.4.2 End-to-End Pipeline Test
**Acceptance Criteria:**
- [ ] –û–¥–∏–Ω E2E —Ç–µ—Å—Ç –ø—Ä–æ–≥–æ–Ω—è–µ—Ç query —á–µ—Ä–µ–∑ –≤–µ—Å—å pipeline:
  - User query ‚Üí PLAN (real Claude) ‚Üí VEE ‚Üí GATE ‚Üí DEBATE (real LLM) ‚Üí Response
- [ ] Validates:
  - All pipeline steps execute
  - No hallucinations detected
  - Response includes disclaimer
  - Cost logged correctly
  - Audit trail created
- [ ] –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: < 30s

**–§–∞–π–ª:** `tests/integration/test_e2e_real_llm.py`

---

## üü° PHASE 2: HIGH PRIORITY (Week 12) ‚Äî Should Have

**–¶–µ–ª—å:** –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, observability, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

### 2.1 Performance & Scalability (–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 5‚Üí8)

#### 2.1.1 Load Testing & Benchmarking
**Effort:** M (2 –¥–Ω—è)

**Acceptance Criteria:**
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å Locust load test (—É–∂–µ —Å–æ–∑–¥–∞–Ω –≤ Week 9 Day 5):
  ```bash
  locust -f tests/performance/locustfile.py \
    --users 100 \
    --spawn-rate 10 \
    --run-time 10m \
    --html reports/load_test_2026_02_15.html
  ```
- [ ] –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å baseline metrics:
  - RPS (Requests Per Second): target ‚â•10
  - P95 latency: < 5s
  - P99 latency: < 10s
  - Success rate: ‚â•95%
  - Concurrent users: 100
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `tests/performance/results/`
- [ ] CI/CD: performance regression test –Ω–∞ –∫–∞–∂–¥—ã–π PR

---

#### 2.1.2 Async Orchestrator
**Effort:** L (5 –¥–Ω–µ–π)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `LangGraphOrchestrator` –≤ async –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è blocking.

**Acceptance Criteria:**
- [ ] `LangGraphOrchestrator.execute()` ‚Üí `async execute()`
- [ ] –í—Å–µ nodes (PLAN, FETCH, VEE, GATE, DEBATE) async
- [ ] Background task queue (Celery –∏–ª–∏ FastAPI BackgroundTasks)
- [ ] WebSocket –¥–ª—è real-time progress updates
- [ ] Benchmark: 10x improvement –≤ throughput

---

#### 2.1.3 Auto-Scaling (HPA)
**Effort:** S (1 –¥–µ–Ω—å)

**Acceptance Criteria:**
- [ ] Kubernetes HorizontalPodAutoscaler:
  ```yaml
  apiVersion: autoscaling/v2
  kind: HorizontalPodAutoscaler
  metadata:
    name: ape-api
  spec:
    scaleTargetRef:
      apiVersion: apps/v1
      kind: Deployment
      name: ape-api
    minReplicas: 2
    maxReplicas: 20
    metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  ```
- [ ] Stress test: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç 2 –¥–æ 20 pods

---

### 2.2 Observability (–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å: 6‚Üí8)

#### 2.2.1 Distributed Tracing
**Effort:** M (2 –¥–Ω—è)

**Acceptance Criteria:**
- [ ] OpenTelemetry integration
- [ ] Jaeger backend –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ traces
- [ ] Trace –∫–∞–∂–¥–æ–≥–æ query —á–µ—Ä–µ–∑ –≤–µ—Å—å pipeline (PLAN ‚Üí VEE ‚Üí GATE ‚Üí DEBATE)
- [ ] Custom spans –¥–ª—è:
  - LLM API calls (with latency breakdown)
  - Database queries
  - VEE code execution
  - Cache hits/misses
- [ ] Trace sampling: 10% –≤ production (100% –≤ dev)

**–ü—Ä–∏–º–µ—Ä trace:**
```
Query abc123 (total: 8.2s)
‚îú‚îÄ PLAN node (2.1s)
‚îÇ  ‚îî‚îÄ Claude API call (1.9s)
‚îú‚îÄ FETCH node (0.3s)
‚îÇ  ‚îî‚îÄ yfinance API call (0.2s)
‚îú‚îÄ VEE node (1.8s)
‚îÇ  ‚îî‚îÄ Docker exec (1.6s)
‚îú‚îÄ GATE node (0.5s)
‚îî‚îÄ DEBATE node (3.5s)
   ‚îî‚îÄ DeepSeek API call (3.3s)
```

---

#### 2.2.2 Alerting
**Effort:** S (1 –¥–µ–Ω—å)

**Acceptance Criteria:**
- [ ] Alertmanager –¥–ª—è Prometheus
- [ ] Alert rules:
  - API error rate > 5% (5min window)
  - P95 latency > 10s
  - LLM cost > $100/day
  - Memory usage > 90%
  - Disk usage > 80%
- [ ] –ö–∞–Ω–∞–ª—ã: Slack, Email, PagerDuty (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

### 2.3 Architecture Refactoring (–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: 7‚Üí9)

#### 2.3.1 –†–∞–∑–±–∏—Ç—å main.py –Ω–∞ Routers
**Effort:** S (2 –¥–Ω—è)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–£—Å—Ç—Ä–∞–Ω–∏—Ç—å God Object (947 LOC) –ø—É—Ç–µ–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ FastAPI routers.

**Acceptance Criteria:**
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
  ```
  src/api/
  ‚îú‚îÄ‚îÄ main.py (100 LOC max - —Ç–æ–ª—å–∫–æ app init)
  ‚îú‚îÄ‚îÄ routers/
  ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
  ‚îÇ   ‚îú‚îÄ‚îÄ query.py (submit_query, get_status)
  ‚îÇ   ‚îú‚îÄ‚îÄ episodes.py (get_episode)
  ‚îÇ   ‚îú‚îÄ‚îÄ facts.py (get_facts)
  ‚îÇ   ‚îú‚îÄ‚îÄ health.py (health, metrics)
  ‚îÇ   ‚îî‚îÄ‚îÄ admin.py (admin endpoints)
  ‚îú‚îÄ‚îÄ dependencies.py (shared dependencies)
  ‚îî‚îÄ‚îÄ middleware/ (existing)
  ```
- [ ] –ö–∞–∂–¥—ã–π router < 200 LOC
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

#### 2.3.2 WebSocket State –≤ Redis
**Effort:** M (2 –¥–Ω—è)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å `ConnectionManager` state –∏–∑ –ø–∞–º—è—Ç–∏ –≤ Redis Pub/Sub –¥–ª—è stateless deployment.

**Acceptance Criteria:**
- [ ] WebSocket subscriptions —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Redis:
  ```python
  # Key: ws:query:{query_id}
  # Value: Set of connection IDs
  ```
- [ ] Pub/Sub –¥–ª—è broadcast updates:
  ```python
  await redis.publish(
      f"ws:query:{query_id}",
      json.dumps({"type": "status", "data": {...}})
  )
  ```
- [ ] –ü—Ä–∏ restart pod'–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è (reconnect)
- [ ] Load test: 1000 concurrent WebSocket connections

---

### 2.4 Database Migrations (–î–∞–Ω–Ω—ã–µ –∏ –ë–î: 7‚Üí9)

#### 2.4.1 Alembic Integration
**Effort:** S (1 –¥–µ–Ω—å)

**Acceptance Criteria:**
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∫–∞: `pip install alembic`
- [ ] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: `alembic init alembic`
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö init_scripts –≤ Alembic:
  ```
  alembic/versions/
  ‚îú‚îÄ‚îÄ 001_create_verified_facts_table.py
  ‚îú‚îÄ‚îÄ 002_create_episodes_table.py
  ‚îú‚îÄ‚îÄ 003_create_query_costs_table.py
  ‚îî‚îÄ‚îÄ 004_create_llm_api_usage_table.py
  ```
- [ ] CI/CD: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π `alembic upgrade head` –ø—Ä–∏ deploy
- [ ] Rollback –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –≤ runbook

---

## üü¢ PHASE 3: MEDIUM PRIORITY (Week 13) ‚Äî Could Have

**–¶–µ–ª—å:** –£–ª—É—á—à–∏—Ç—å UX, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 3.1 Frontend E2E Tests (Frontend/UX: 6‚Üí8)

#### 3.1.1 Playwright Integration
**Effort:** M (3 –¥–Ω—è)

**Acceptance Criteria:**
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∫–∞: `npm install -D @playwright/test`
- [ ] Config: `playwright.config.ts`
- [ ] E2E —Ç–µ—Å—Ç—ã (–º–∏–Ω–∏–º—É–º 10):
  1. User login flow
  2. Submit query
  3. View query status (pipeline animation)
  4. View results (facts table)
  5. Debate perspectives
  6. Export CSV/JSON
  7. Chart interactions
  8. Disclaimer modal
  9. Error handling (invalid query)
  10. Mobile responsiveness
- [ ] CI/CD: –∑–∞–ø—É—Å–∫ –Ω–∞ –∫–∞–∂–¥—ã–π PR (headless mode)
- [ ] Visual regression testing (Percy –∏–ª–∏ Chromatic)

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
npx playwright test
npx playwright test --ui  # Interactive mode
```

---

### 3.2 Security Enhancements (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: 6‚Üí8)

#### 3.2.1 Penetration Testing
**Effort:** M (external contractor, 1 week)

**Acceptance Criteria:**
- [ ] OWASP Top 10 —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] VEE Sandbox security review (container escape, privilege escalation)
- [ ] API rate limiting bypass attempts
- [ ] SQL injection, XSS, CSRF —Ç–µ—Å—Ç—ã
- [ ] –û—Ç—á–µ—Ç —Å –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–µ–π —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- [ ] Remediation –ø–ª–∞–Ω

---

#### 3.2.2 JWT –¥–ª—è Frontend Sessions
**Effort:** S (2 –¥–Ω—è)

**Acceptance Criteria:**
- [ ] JWT –≤–º–µ—Å—Ç–æ API keys –¥–ª—è frontend auth
- [ ] Refresh token mechanism
- [ ] Expiration: Access token 15min, Refresh token 7 days
- [ ] Secure cookie storage (httpOnly, secure, sameSite)

---

### 3.3 ML/AI Enhancements (ML/AI Pipeline: 9‚Üí9)

#### 3.3.1 MLflow/W&B Integration
**Effort:** M (3 –¥–Ω—è)

**Acceptance Criteria:**
- [ ] MLflow tracking –¥–ª—è:
  - Prompt versions
  - LLM provider comparisons
  - Golden Set accuracy metrics
  - Cost per experiment
- [ ] UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤: `http://localhost:5000`

---

#### 3.3.2 Data/Concept Drift Detection
**Effort:** M (3 –¥–Ω—è)

**Acceptance Criteria:**
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤:
  - Input query distribution (topic shift)
  - LLM response patterns
  - Accuracy degradation over time
- [ ] Alert –ø—Ä–∏ drift > 10% –æ—Ç baseline
- [ ] Weekly drift report

---

## ‚ö™ PHASE 4: LOW PRIORITY (Week 14) ‚Äî Won't Have (–¥–ª—è v1.0)

**–¶–µ–ª—å:** Nice-to-have features –¥–ª—è –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏–π

### 4.1 Advanced Features
- Paper trading –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- A/B testing infrastructure (feature flags)
- CDN –¥–ª—è frontend static assets
- Canary deployments
- Multi-region deployment
- GraphQL API (–≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ REST)
- Mobile app (React Native)

---

## üìÖ –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω –ø–æ –Ω–µ–¥–µ–ª—è–º

### Week 11: CRITICAL FIXES (Feb 11-17)
**–¶–µ–ª—å:** –£—Å—Ç—Ä–∞–Ω–∏—Ç—å show-stoppers

| Day | –ó–∞–¥–∞—á–∞ | Effort | Owner |
|-----|--------|--------|-------|
| Mon | 1.1.1 LLM Orchestrator Integration | M | Backend |
| Tue | 1.1.1 (continue) + 1.1.2 Async LLM | M | Backend |
| Wed | 1.2.1 Disclaimer Integration | S | Full-stack |
| Thu | 1.3.1 Cost Tracking Middleware | S | Backend |
| Fri | 1.4.1 Golden Set Real LLM | M | QA |

**Week 11 Deliverables:**
- ‚úÖ Real LLM integrated with orchestrator
- ‚úÖ Disclaimer –≤ UI –∏ API
- ‚úÖ Cost tracking operational
- ‚úÖ Golden Set baseline established

---

### Week 12: PERFORMANCE & OBSERVABILITY (Feb 18-24)

| Day | –ó–∞–¥–∞—á–∞ | Effort | Owner |
|-----|--------|--------|-------|
| Mon | 2.1.1 Load Testing | M | DevOps |
| Tue | 2.1.2 Async Orchestrator (start) | L | Backend |
| Wed | 2.1.2 Async Orchestrator (continue) | L | Backend |
| Thu | 2.2.1 Distributed Tracing | M | DevOps |
| Fri | 2.3.1 Refactor main.py | S | Backend |

**Week 12 Deliverables:**
- ‚úÖ Load test baseline
- ‚úÖ Async pipeline operational
- ‚úÖ Distributed tracing working
- ‚úÖ main.py refactored

---

### Week 13: UX & SECURITY (Feb 25 - Mar 3)

| Day | –ó–∞–¥–∞—á–∞ | Effort | Owner |
|-----|--------|--------|-------|
| Mon | 3.1.1 Playwright Setup | M | Frontend |
| Tue | 3.1.1 E2E Tests (10 tests) | M | Frontend |
| Wed | 3.2.2 JWT Integration | S | Full-stack |
| Thu | 2.4.1 Alembic Migrations | S | Backend |
| Fri | Buffer –¥–ª—è bug fixes | - | All |

**Week 13 Deliverables:**
- ‚úÖ E2E tests passing
- ‚úÖ JWT authentication
- ‚úÖ Alembic migrations

---

### Week 14: POLISH & VALIDATION (Mar 4-10)

| Day | –ó–∞–¥–∞—á–∞ | Effort | Owner |
|-----|--------|--------|-------|
| Mon | 1.2.2 Audit Trail | M | Backend |
| Tue | 2.2.2 Alerting | S | DevOps |
| Wed | 2.3.2 Redis WebSocket | M | Backend |
| Thu | 1.4.2 E2E Pipeline Test | M | QA |
| Fri | Final validation + docs | - | All |

**Week 14 Deliverables:**
- ‚úÖ Audit trail immutable
- ‚úÖ Alerts configured
- ‚úÖ WebSocket stateless
- ‚úÖ Full E2E test passing

---

## üìà –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–∞—è –∏—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –î–æ | –ü–æ—Å–ª–µ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-----|-------|-------------|
| ML/AI Pipeline | 5 | **9** | Real LLM + MLflow + drift detection |
| –ë–∏–∑–Ω–µ—Å/Compliance | 2 | **8** | Disclaimer + audit trail + cost tracking |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | 5 | **8** | Async + load tests + auto-scaling |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 7 | **9** | E2E + real LLM tests + 95% coverage |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 6 | **8** | Pentest + JWT + hardening |
| –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å | 6 | **8** | Distributed tracing + alerting |
| Frontend/UX | 6 | **8** | E2E tests + UX improvements |
| –î–∞–Ω–Ω—ã–µ –∏ –ë–î | 7 | **9** | Alembic + optimizations |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 7 | **9** | Refactoring + async + stateless |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 9 | **9** | Maintain excellence |
| **–û–ë–©–ê–Ø** | **6.1** | **8.5** | **Production-Ready ‚úÖ** |

---

## üéØ Success Metrics (Definition of Done)

### Technical Metrics
- [ ] **Test Coverage:** ‚â•95% (pytest --cov-fail-under=95)
- [ ] **Golden Set Accuracy:** ‚â•90%
- [ ] **Hallucination Rate:** 0%
- [ ] **Load Test:** 100 concurrent users, P95 < 5s, Success ‚â•95%
- [ ] **E2E Tests:** 10+ passing Playwright tests
- [ ] **Security:** 0 critical vulnerabilities (pentest)
- [ ] **Cost per Query:** < $0.001 (with DeepSeek)

### Business Metrics
- [ ] **Compliance:** Disclaimer –≤ 100% responses
- [ ] **Audit Trail:** 100% queries logged immutably
- [ ] **Uptime:** 99.9% (monitored)
- [ ] **Break-even:** Unit economics –º–æ–¥–µ–ª—å —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞

### Operational Metrics
- [ ] **Deployment:** CI/CD pipeline –±–µ–∑ —Ä—É—á–Ω—ã—Ö —à–∞–≥–æ–≤
- [ ] **Monitoring:** 0 blind spots (full tracing)
- [ ] **Alerting:** 100% critical events alerted
- [ ] **Documentation:** Runbooks –¥–ª—è –≤—Å–µ—Ö critical scenarios

---

## üö® Risks & Mitigation

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| LLM API outages | High | High | Circuit breaker + fallback + caching |
| Cost overrun | Medium | High | Cost tracking + daily budget alerts |
| Performance degradation | Medium | High | Load testing before each release |
| Security breach | Low | Critical | Pentest + security review + monitoring |
| Bus factor = 1 | High | High | Comprehensive documentation + code reviews (AI) |

---

## üìö Dependencies

### External
- [ ] Penetration testing contractor (Week 13)
- [ ] Legal review of disclaimer text (Week 11)
- [ ] Budget approval –¥–ª—è LLM API costs ($500/month estimated)

### Internal
- [ ] Week 11 Day 1 COMPLETE ‚úÖ (LLM integration —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)
- [ ] API keys configured: OpenAI, Gemini, DeepSeek ‚úÖ
- [ ] Infrastructure running: TimescaleDB, Neo4j, Redis ‚úÖ

---

## üìù Out of Scope (–¥–ª—è v1.0)

- Multi-language support (—Ç–æ–ª—å–∫–æ English)
- Mobile app
- Multi-tenancy (single-tenant –¥–ª—è v1.0)
- Custom ML models (—Ç–æ–ª—å–∫–æ LLM API)
- Real-time market data (—Ç–æ–ª—å–∫–æ historical data)
- Trading execution (read-only analysis only)

---

## üéì Learning & Knowledge Transfer

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è Bus Factor Mitigation:**
- [ ] Architecture Decision Records (ADR) –¥–ª—è –≤—Å–µ—Ö major decisions
- [ ] Runbooks –¥–ª—è critical procedures
- [ ] Video walkthrough –ø—Ä–æ–µ–∫—Ç–∞ (30 min)
- [ ] Onboarding guide –¥–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- [ ] Weekly summary –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –≤ `docs/weekly_summaries/`

---

## ‚úÖ Acceptance Process

### Code Review
- [ ] –í—Å–µ PR require review (–¥–∞–∂–µ –æ—Ç AI)
- [ ] Automated checks: lint, test, security scan
- [ ] Manual review: architecture, business logic

### QA Process
- [ ] Unit tests pass (pytest)
- [ ] Integration tests pass (with real APIs)
- [ ] E2E tests pass (Playwright)
- [ ] Load test baseline maintained
- [ ] Security scan clean

### Deployment Approval
- [ ] Staging environment validation
- [ ] Blue-green deployment –≥–æ—Ç–æ–≤–æ –∫ rollback
- [ ] Monitoring dashboards configured
- [ ] Runbook updated

---

## üìû Stakeholders

| Role | Responsibility | Contact |
|------|----------------|---------|
| Product Owner | Prioritization, acceptance | - |
| Tech Lead | Architecture, code review | Solo dev |
| QA | Test strategy, Golden Set | Solo dev |
| DevOps | Infrastructure, monitoring | Solo dev |
| Legal | Disclaimer approval | External |
| Security | Pentest, review | External |

---

## üèÅ Final Checklist

–ü–µ—Ä–µ–¥ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ–º Production-Ready:

### Technical
- [ ] All PHASE 1 tasks complete (Week 11)
- [ ] All PHASE 2 tasks complete (Week 12)
- [ ] Load test passed
- [ ] Security pentest passed
- [ ] E2E tests passing
- [ ] Monitoring & alerting operational

### Business
- [ ] Legal disclaimer approved
- [ ] Unit economics validated
- [ ] Pricing strategy approved
- [ ] Terms of Service published
- [ ] Privacy Policy published

### Operational
- [ ] Runbooks complete
- [ ] On-call rotation defined (even if solo)
- [ ] Incident response plan
- [ ] Backup & restore tested
- [ ] Disaster recovery plan

---

**Version:** 1.0
**Created:** 2026-02-08
**Based on:** Claude Opus 4.6 Comprehensive Evaluation
**Next Review:** After Week 11 completion
**Estimated Completion:** 2026-03-10 (4 weeks)

---

> **Note:** –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç ‚Äî –∂–∏–≤–æ–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç. –û–±–Ω–æ–≤–ª—è—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –Ω–µ–¥–µ–ª–∏ —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è–º–∏.
